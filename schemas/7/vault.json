{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://uno.app/schemas/7/vault.json",
  "title": "Vault",
  "description": "Uno Vault",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "idCardValue": "string",
    "vaultSchemaMajor": "integer",
    "uuid": {
      "type": "string",
      "format": "uuid"
    },
    "email": {
      "type": "string",
      "format": "idn-email"
    },
    "validatedPhoneNumber": "string",
    "name": "string",
    "manualItems": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/manualItem"
      }
    },
    "vault": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/vaultItem"
      }
    },
    "privateKeys": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/privateKey"
      }
    },
    "groups": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/group"
      }
    },
    "contacts": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/contact"
      }
    },
    "confidants": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/contact"
      }
    },
    "friends": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/contact"
      }
    },
    "oldPasswords": {
      "type": "array",
      "items": "string"
    },
    "creditCards": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/creditCard"
      }
    },
    "addresses": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/address"
      }
    },
    "notes": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/note"
      }
    },
    "refreshTokens": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/refreshToken"
      }
    },
    "personas": "array",
    "travel": "array",
    "wifi": "array",
    "wiringDetails": "array"
  },
  "required": [
    "idCardValue",
    "vaultSchemaMajor",
    "uuid",
    "contacts",
    "confidants",
    "oldPasswords",
    "vault"
  ],
  "$defs": {
    "contact": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "givenName": "string",
        "fullName": "string",
        "initials": "string",
        "phoneNumber": "string",
        "state": { "enum": ["denied", "error", "pending", "protecting", "recovery", "removing", "owner", "readonly"] },
        "id": { 
          "type": "string",
          "format": "uuid"
        },
        "share": "string",
        "signingKey": "string",
        "encryptionKey": "string",
        "oldShares": {
          "type": "array",
          "items": "string"
        },
        "session": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "seed": "string"
          },
          "required": ["seed"]
        }
      },
      "required": ["givenName", "oldShares", "fullName", "initials", "phoneNumber", "id"]
    },
    "refreshToken": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "clientId": "string",
        "refreshToken": "string"
      },
      "required": ["id", "clientId", "refreshToken"]
    },
    "note": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "title": "string",
        "notes": "string"
      },
      "required": ["id", "title", "notes"]
    },
    "address": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "line1": "string",
        "line2": "string",
        "city": "string",
        "state": "string",
        "zip": "string",
        "country": "string"
      },
      "required": ["id", "line1", "city", "state", "zip", "country"]
    },
    "creditCard": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "type": "string",
        "name": "string",
        "holder": "string",
        "number": "string",
        "expiration": {
          "type": "string",
          "pattern": "^[0,1][0-9]{3}$"
        },
        "cvv": {
          "type": "string",
          "minLength": 3,
          "maxLength": 4
        },
        "addressUUID": {
          "type": "string",
          "format": "uuid"
        }
      },
      "required": ["id", "holder", "number", "expiration"]
    },
    "group": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "seed": "string",
        "ownerPublicSigningKey": "string"
      },
      "required": ["ownerPublicSigningKey", "seed", "id"]
    },
    "privateKey": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": "string",
        "key": "string",
        "password": "string",
        "walletAddresses": {
          "type": "array",
          "items": "string"
        },
        "notes": "string",
        "url": "string",
        "id": {
          "type": "string",
          "format": "uuid"
        }
      },
      "required": ["name", "key", "id"]
    },
    "relatedItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "password": "string",
        "otpSeed": "string"
      }
    },
    "ssoProvider": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "default": "boolean",
        "provider": "string",
        "username": "string"
      },
      "required": ["default", "provider", "username"]
    },
    "vaultItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": "string",
        "username": "string",
        "password": "string",
        "intendedPassword": "string",
        "intendedOTPSeed": "string",
        "otpSeed": "string",
        "notes": "string",
        "relatedItems": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/relatedItem"
          }
        },
        "ssoProvider": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ssoProvider"
          }
        }
      },
      "required": ["id", "name"]
    },
    "manualItem": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": "string",
        "url": "string",
        "username": "string",
        "password": "string",
        "intendedPassword": "string",
        "otpSeed": "string",
        "notes": "string",
        "ssoProvider": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ssoProvider"
          }
        },
        "relatedItems": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/relatedItem"
          }
        }
      },
      "required": ["id"]
    }
  }
}
